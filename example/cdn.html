<!DOCTYPE html>
<html>
  <head>
    <title>SuperSonic CDN Demo</title>
  </head>
  <body>
    <h1>SuperSonic CDN Demo</h1>
    <p>Everything loaded from CDN - no server setup required!</p>
    <button id="play">Play Amen Break</button>

    <script type="module">
      // Everything from CDN - works without COOP/COEP headers
      import { SuperSonic } from "https://unpkg.com/supersonic-scsynth@0.21.3/dist/supersonic.js";

      const button = document.getElementById("play");
      let sonic = null;

      button.onclick = async () => {
        if (!sonic) {
          button.textContent = "Booting scsynth...";

          sonic = new SuperSonic({
            // All assets from CDN
            workerBaseURL: "https://unpkg.com/supersonic-scsynth@0.21.3/dist/workers/",
            wasmBaseURL: "https://unpkg.com/supersonic-scsynth@0.21.3/dist/wasm/",
            sampleBaseURL: "https://unpkg.com/supersonic-scsynth-samples@0.21.3/samples/",
            synthdefBaseURL: "https://unpkg.com/supersonic-scsynth-synthdefs@0.21.3/synthdefs/",
            // postMessage mode works without COOP/COEP headers
            mode: "postMessage",
          });

          await sonic.init();
          await sonic.loadSynthDefs(["sonic-pi-basic_stereo_player"]);
          await sonic.loadSample(0, "loop_amen.flac");
          button.textContent = "Play Amen Break";
        }

        sonic.send(
          "/s_new",
          "sonic-pi-basic_stereo_player",
          -1,
          0,
          0,
          "buf",
          0
        );
      };
    </script>
  </body>
</html>
